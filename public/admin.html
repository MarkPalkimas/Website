<!DOCTYPE html>
<html lang="en">
<head>…</head>
<body>
  …
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";

    const app = initializeApp({
      apiKey: "AIzaSyDds9UCMOcaoGT753uMNcT0y9847jN0oEI",
      authDomain: "mark-palkimas-visits.firebaseapp.com",
      projectId: "mark-palkimas-visits"
    });
    const db = getFirestore(app);

    async function getLogsGroupedByIP() {
      const snap = await getDocs(collection(db, "visitors"));
      console.log("[admin.html] raw snapshot size:", snap.size);
      const grouped = {};
      snap.forEach(doc => {
        const d = doc.data();
        // …grouping logic…
      });
      const arr = Object.values(grouped)
        .sort((a,b)=>new Date(b.latestTime)-new Date(a.latestTime));
      console.log("[admin.html] Logs loaded:", arr);
      return arr;
    }

    function populateTable(logs) {
      … // your existing code
    }

    document.addEventListener("DOMContentLoaded", async () => {
      try {
        const logs = await getLogsGroupedByIP();
        populateTable(logs);
      } catch (e) {
        console.error("Failed to load visitor logs:", e);
      }
    });
  </script>
</body>
</html>
